<%- include('layout', { body: `

<section class="max-w-4xl mx-auto px-4 py-12">

    <!-- Header -->
    <div class="text-center mb-10">
        <h1 class="text-3xl font-bold mb-2">Bitcoin Reviews</h1>
        <p class="text-gray-600">Real experiences spending Bitcoin at Roatan merchants</p>
    </div>

    ${typeof error !== 'undefined' && error ? `
    <div class="bg-red-50 border border-red-300 rounded-lg p-4 mb-6">
        <p class="text-red-700">${error}</p>
    </div>
    ` : ''}

    ${typeof reviews !== 'undefined' && reviews.length === 0 ? `
    <div class="text-center py-20 text-gray-500">
        <div class="text-5xl mb-4">üîç</div>
        <p class="text-lg font-medium">No approved reviews yet</p>
        <p class="mt-2">Be the first! <a href="/submit" class="text-bitcoin hover:underline">Submit your review</a></p>
    </div>
    ` : ''}

    <!-- Featured Reviews -->
    ${typeof featuredReviews !== 'undefined' && featuredReviews.length > 0 ? `
    <div class="mb-12">
        <h2 class="text-xl font-bold mb-5 flex items-center gap-2">
            <span>‚≠ê</span> Featured Reviews
        </h2>
        <div class="grid gap-6 md:grid-cols-2">
            ${featuredReviews.map(review => `
            <div class="bg-gradient-to-br from-orange-50 to-amber-50 border-2 border-bitcoin rounded-xl p-6 shadow-md">
                <div class="flex items-start justify-between mb-3">
                    <div>
                        <span class="inline-flex items-center gap-1 bg-bitcoin text-white text-xs font-bold px-2 py-1 rounded-full mb-2">
                            ‚≠ê Featured
                        </span>
                        <h3 class="font-bold text-gray-900">${review.merchant_name ? review.merchant_name.replace(/</g, '&lt;').replace(/>/g, '&gt;') : 'Roatan Merchant'}</h3>
                    </div>
                    <span class="text-xs text-gray-500 mt-1 whitespace-nowrap ml-4">
                        ${new Date(review.submitted_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                    </span>
                </div>
                ${review.review_text ? `
                <blockquote class="text-gray-700 text-sm italic border-l-4 border-bitcoin pl-3 mb-4">
                    "${review.review_text.length > 300 ? review.review_text.substring(0, 300).replace(/</g, '&lt;').replace(/>/g, '&gt;') + '‚Ä¶' : review.review_text.replace(/</g, '&lt;').replace(/>/g, '&gt;')}"
                </blockquote>
                ` : ''}
                <a href="${review.review_link}" target="_blank" rel="noopener noreferrer"
                   class="inline-flex items-center gap-1 text-sm font-semibold text-bitcoin hover:text-bitcoin-dark transition">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"/><path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"/></svg>
                    Read on Google Maps
                </a>
            </div>
            `).join('')}
        </div>
    </div>
    ` : ''}

    <!-- All Approved Reviews -->
    ${typeof regularReviews !== 'undefined' && regularReviews.length > 0 ? `
    <div>
        ${typeof featuredReviews !== 'undefined' && featuredReviews.length > 0 ? '<h2 class="text-xl font-bold mb-5">All Reviews</h2>' : ''}
        <div class="space-y-4">
            ${regularReviews.map(review => `
            <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md transition">
                <div class="flex items-start justify-between mb-2">
                    <div class="flex-1 min-w-0">
                        <h3 class="font-semibold text-gray-900 truncate">
                            ${review.merchant_name ? review.merchant_name.replace(/</g, '&lt;').replace(/>/g, '&gt;') : '<span class="text-gray-400 italic">Roatan merchant</span>'}
                        </h3>
                    </div>
                    <span class="text-xs text-gray-400 ml-4 whitespace-nowrap mt-0.5">
                        ${new Date(review.submitted_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                    </span>
                </div>
                ${review.review_text ? `
                <p class="text-gray-600 text-sm mb-3 line-clamp-3 italic">
                    "${review.review_text.length > 200 ? review.review_text.substring(0, 200).replace(/</g, '&lt;').replace(/>/g, '&gt;') + '‚Ä¶' : review.review_text.replace(/</g, '&lt;').replace(/>/g, '&gt;')}"
                </p>
                ` : `
                <p class="text-gray-400 text-sm mb-3 italic">No review text provided</p>
                `}
                <a href="${review.review_link}" target="_blank" rel="noopener noreferrer"
                   class="inline-flex items-center gap-1 text-sm font-medium text-bitcoin hover:text-bitcoin-dark transition">
                    <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"/><path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"/></svg>
                    View on Google Maps
                </a>
            </div>
            `).join('')}
        </div>
    </div>
    ` : ''}

    <!-- Submit CTA -->
    ${typeof reviews !== 'undefined' && reviews.length > 0 ? `
    <div class="mt-12 text-center bg-orange-50 rounded-xl p-8 border border-orange-100">
        <p class="text-gray-700 font-medium mb-4">Visited a Bitcoin merchant in Roatan recently?</p>
        <a href="/submit" class="inline-block bg-bitcoin hover:bg-bitcoin-dark text-white font-bold px-8 py-3 rounded-lg transition">
            Submit Your Review
        </a>
    </div>
    ` : ''}

</section>

`, donationAddress: typeof donationAddress !== 'undefined' ? donationAddress : 'Coming soon' }) %>
